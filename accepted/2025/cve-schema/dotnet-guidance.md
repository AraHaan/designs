# .NET CVE Schema Implementation Guidance

The CVE schema provides a structured approach to sharing CVE information. This document describes the way in which it will be used to describe .NET CVEs.

The schema uses strings to encode product, platform, and package names. This approach was adopted as generalizing and compatibility-preserving principles (as oposed to codifying all string as enums) and therefore requires an out-of-schema taxonomy on which strings to expect. The taxonomy will be provided as JSON to make it easy to use or at the very least turn into documentation.

The taxonomy is organized into separate JSON files by category:
- [products.json](products.json) - Official .NET product identifiers
- [platforms.json](platforms.json) - Supported operating system platforms
- [architectures.json](architectures.json) - Supported processor architectures
- [severity.json](severity.json) - CVE severity levels
- [cnas.json](cnas.json) - CVE Numbering Authorities

These "taxonomy" strings will always use kebab-case-lower format. It is important that they are in a consistent format to enable them to be used as convenient query currency. Brand names, like macOS or Windows, will also use kebab-case-lower. The JSON file mentioned above will include display names to bridge the divide between query currency and expected display format. An exception is package names. They will be recorded with the official casing as displayed on nuget.org.

## CNA

The CNA for .NET CVEs is Microsoft. The CVE JSON files that Microsoft publishes will always attribute Microsoft as the CNA.

## Products

The following products are part of the .NET product family, all prepended with the `dotnet-` for clear namespacing to improve scenarios where runtimes from multiple ecosystems might be processed and/or displayed.

- `dotnet-runtime` -- The .NET runtime libraries, such as CoreCLR and System.Text.Json
- `dotnet-aspnetcore` -- The ASP.NET Core runtime, such as Kestrel and ASP.NET MVC
- `dotnet-windows-desktop` -- Windows-specific libraries, such as Windows Forms, WPF, and WinRT bindings
- `dotnet-sdk` -- The primary developer component, including the CLI, MSBuild, and all of the runtime libraries

Products should be classified on whether they contain a vulnerability in any distribution. For example, the .NET SDK includes .NET runtime libraries in most (or all) distributions and should be declared to have the same vulnerability as is actually present in the .NET runtime libraries. This classification helps users know which deployments need to be updated.

## Platforms

.NET can be run on many operating systems. The platforms listed in .NET CVE JSON are going to be those supported by a given publisher. This document will focus on the set supported by Microsoft.

- `linux` -- Linux distros, such as Alpine, Red Hat, and Ubuntu
- `macos` -- Apple macOS
- `windows` -- Microsoft Windows
- `all` -- All operating systems or more accurately not specific to OS-specific libraries or OS-specific interaction

There is no affordance for specifying an OS version, for example describing a .NET vulnerability specific to Ubuntu 24.04 and not 22.04. Such a scenario would be very unique and unnecessarily complicate the schema and schema readers. If such a scenario ever occurs, the `description` property will be used to clarify this nuance.

## Architectures

.NET can be run on many architectures. The architectures listed in .NET CVE JSON are going to be those supported by a given publisher. This document will focus on the set supported by Microsoft. This is the same model as platforms, above.

- `arm` -- Arm32 (32-bit; AKA armhf) 
- `arm64` -- Arm64 (64-bit)
- `x64` -- x86-x64 (64-bit)
- `x86` -- x86 (32-bit)
- `all` -- All architectures or more accurately not specific to arch-specific libraries or architecture-specific interaction

There is no addordance for specifying a architecture version, for example describing a .NET vulnerability specific to Armv8.2 and not Armv8.1. Such a scenario would be very unique and unnecessarily complicate the schema and schema readers. If such a scenario ever occurs, the `description` property will be used to clarify this nuance.

## References

Each CVE will include one or more references, in a `string[]`. The first reference will be the `dotnet/announcements` issue that is the primary GitHub disclosure.

## Annotated JSON

This following schema segments and annotations provide more detailed and contextual information on how the schema is used.

The following CVE object describes a CVE that affects all platforms and architectures. The `references` property links to official GitHub announcement from the .NET Team.

```json
    {
      "id": "CVE-2024-30105",
      "problem": ".NET Denial of Service Vulnerability",
      "severity": "critical",
      "disclosed": "2024-07-09",
      "cvss": {"version": "3.1", "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:U/RL:O/RC:C"},
      "description": [
        "A vulnerability exists in .NET when calling the JsonSerializer.DeserializeAsyncEnumerable method against an untrusted input using System.Text.Json may result in Denial of Service."
      ],
      "platforms": [
        "all"
      ],
      "architectures": [
        "all"
      ],
      "cna": "microsoft",
      "references": [
        "https://github.com/dotnet/announcements/issues/315"
      ]
    }
```

The following product object describes a CVE affecting `dotnet-runtime`. The `min_vulnerable`, `max_vulnerable`, and `fixed` properties describe 3-part verson numbers. The `release` property describes the two-part version, avoiding the need for consumers to strip the last version for various display or comparison needs.

```json
    {
      "cve_id": "CVE-2024-38081",
  "name": "dotnet-runtime",
      "min_vulnerable": "6.0.0",
      "max_vulnerable": "6.0.31",
      "fixed": "6.0.32",
      "release": "6.0",
      "commits": [
        "0a0dd0e27560e692e11ee286ed9f45471b2131fa"
      ]
    }
```

The following extension pobject describes a package affecting [`System.Text.Json`](https://www.nuget.org/packages/System.Text.Json/). As called out earlier, the casing used on nuget.org is preferred, as opposed to the kebab-case-lower scheme used elsewhere. 

```json
    {
      "cve_id": "CVE-2024-30105",
      "name": "System.Text.Json",
      "min_vulnerable": "8.0.0",
      "max_vulnerable": "8.0.3",
      "fixed": "8.0.4",
      "release": "8.0",
      "commits": [
        "fa5b0d8f4a8b424732cc992158aa92842f8a2846"
      ]
    }
```

`System.Text.Json` is particularly interesting because it is present in both the `dotnet-runtime` product and as a package on nuget.org. This dynamic is discussed in more detail in [.NET Package Servicing Model](https://github.com/dotnet/core/blob/main/Documentation/policies/package-servicing.md).
